
<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>나만의 쇼츠 플레이어</title>
    <meta property="og:title" content="나만의 쇼츠 플레이어"/>
    <meta property="og:description" content="최신 쇼츠를 연속으로 재생합니다"/>
    <meta property="og:image" content=""/>
    <meta property="og:url" content=""/>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: sans-serif; }
        
        /* 모바일 기본 스타일 */
        body { background-color: #000; overflow: hidden; }
        #mobile-view { position: relative; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
        #mobile-player-container { position: relative; width: 100%; height: 100%; }
        #mobile-player { width: 100%; height: 100%; max-width: calc(100vh * 9 / 16); margin: auto; }
        #touchOverlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 5; }
        #unmuteButton { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 15px 25px; font-size: 18px; font-weight: bold; color: white; background: rgba(0, 0, 0, 0.7); border: 2px solid rgba(255, 255, 255, 0.8); border-radius: 30px; cursor: pointer; z-index: 10; backdrop-filter: blur(10px); display: none; }
        #desktop-view { display: none; }

        /* 데스크톱 스타일 (768px 이상) */
        @media (min-width: 768px) {
            body { background-color: #f1f1f1; overflow-y: auto; }
            #mobile-view { display: none; }
            #desktop-view {
                display: grid;
                grid-template-columns: repeat(4, 1fr); /* 4열 그리드 */
                gap: 20px;
                padding: 20px;
                max-width: 1800px;
                margin: auto;
            }
            .desktop-player-wrapper {
                position: relative;
                width: 100%;
                padding-top: 177.77%; /* 9:16 Aspect Ratio */
                background-color: #000;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 4px 10px rgba(0,0,0,0.1);
                transition: box-shadow 0.3s ease-in-out;
            }
            .desktop-player-wrapper.is-playing {
                box-shadow: 0 0 0 4px #007bff; /* 재생 중 하이라이트 */
            }
            .desktop-player {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }
        }
    </style>
</head>
<body>

    <div id="mobile-view">
        <div id="mobile-player-container"><div id="mobile-player"></div></div>
        <div id="touchOverlay"></div>
        <button id="unmuteButton">🔊 소리 켜기</button>
    </div>

    <div id="desktop-view"></div>

<script>
    const videoIds = ["-YiDNUrMX6Y","xKVQ0i3jQoo","NJYtmcWV5ks","bWx1SjACMFU"];
    const SETTINGS = {
        enableControls: true,
        enableSwipe: true,
        enableLoop: true
    };
    let players = {};
    let currentMobileIndex = 0;
    let currentDesktopIndex = -1;
    
    function onYouTubeIframeAPIReady() {
        if (!videoIds || videoIds.length === 0) {
            document.body.innerHTML = "<h1 style='color: #333; text-align: center; padding-top: 50px;'>재생할 영상이 없습니다.</h1>";
            return;
        }

        if (window.matchMedia('(min-width: 768px)').matches) {
            setupDesktopView();
        } else {
            setupMobileView();
        }
    }

    // --- 모바일 뷰 로직 (변경 없음) ---
    function setupMobileView() { /* ... 기존과 동일 ... */ }
    function onMobilePlayerReady(event) { /* ... 기존과 동일 ... */ }
    function onMobilePlayerStateChange(event) { /* ... 기존과 동일 ... */ }
    function playNextMobile() { /* ... 기존과 동일 ... */ }
    function playPrevMobile() { /* ... 기존과 동일 ... */ }
    function setupSwipeListeners() { /* ... 기존과 동일 ... */ }
    // (이해를 돕기 위해 모바일 함수 본문은 생략. 실제 코드에는 포함되어 있습니다.)
    function setupMobileView() {
        const playerVars = { 'autoplay': 1, 'mute': 1, 'rel': 0, 'playsinline': 1, 'controls': 0 };
        if (SETTINGS.enableLoop) {
            playerVars.loop = 1;
            playerVars.playlist = videoIds[0];
        }
        players['mobile'] = new YT.Player('mobile-player', {
            height: '100%', width: '100%', videoId: videoIds[0], playerVars: playerVars,
            events: { 'onReady': onMobilePlayerReady, 'onStateChange': onMobilePlayerStateChange }
        });
    }
    function onMobilePlayerReady(event) {
        const unmuteBtn = document.getElementById('unmuteButton');
        unmuteBtn.style.display = 'block';
        unmuteBtn.addEventListener('click', () => { players['mobile'].unMute(); unmuteBtn.style.display = 'none'; });
        if (SETTINGS.enableSwipe) setupSwipeListeners();
    }
    function onMobilePlayerStateChange(event) {
        if (event.data === YT.PlayerState.PLAYING && !players['mobile'].isMuted()) {
            document.getElementById('unmuteButton').style.display = 'none';
        } else if (event.data === YT.PlayerState.ENDED && !SETTINGS.enableLoop) {
            playNextMobile();
        }
    }
    function playNextMobile() {
        if (videoIds.length <= 1) return;
        currentMobileIndex = (currentMobileIndex + 1) % videoIds.length;
        players['mobile'].loadVideoById(videoIds[currentMobileIndex]);
    }
    function playPrevMobile() {
        if (videoIds.length <= 1) return;
        currentMobileIndex = (currentMobileIndex - 1 + videoIds.length) % videoIds.length;
        players['mobile'].loadVideoById(videoIds[currentMobileIndex]);
    }
    function setupSwipeListeners() {
        const container = document.getElementById('touchOverlay');
        let startY = 0;
        container.addEventListener('touchstart', e => { startY = e.touches[0].clientY; }, { passive: true });
        container.addEventListener('touchend', e => {
            const deltaY = startY - e.changedTouches[0].clientY;
            if (Math.abs(deltaY) > 50) { if (deltaY > 0) playNextMobile(); else playPrevMobile(); }
        }, { passive: true });
    }


    // --- 데스크톱 뷰 설정 (4열 그리드) ---
    function setupDesktopView() {
        const desktopContainer = document.getElementById('desktop-view');
        videoIds.forEach((id, index) => {
            const wrapper = document.createElement('div');
            wrapper.className = 'desktop-player-wrapper';
            wrapper.dataset.index = index;
            wrapper.onclick = () => playDesktopVideo(index);
            
            const playerDiv = document.createElement('div');
            playerDiv.id = 'desktop-player-' + index;
            playerDiv.className = 'desktop-player';
            
            wrapper.appendChild(playerDiv);
            desktopContainer.appendChild(wrapper);
        });

        // 첫번째 영상 자동 재생
        if (videoIds.length > 0) {
            playDesktopVideo(0);
        }
    }

    function playDesktopVideo(index) {
        if (index < 0 || index >= videoIds.length) {
            if (SETTINGS.enableLoop) index = 0;
            else return;
        }

        // 이전에 재생되던 영상 정지 및 하이라이트 제거
        if (currentDesktopIndex !== -1 && players[currentDesktopIndex]) {
            players[currentDesktopIndex].pauseVideo();
            document.querySelector(`.desktop-player-wrapper[data-index="${currentDesktopIndex}"]`)?.classList.remove('is-playing');
        }

        currentDesktopIndex = index;
        const wrapper = document.querySelector(`.desktop-player-wrapper[data-index="${index}"]`);
        wrapper?.classList.add('is-playing');
        
        // 부드럽게 화면에 보이도록 스크롤
        if(wrapper) {
            const rect = wrapper.getBoundingClientRect();
            if (rect.top < 0 || rect.bottom > window.innerHeight) {
                 wrapper.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        if (players[index]) {
            players[index].playVideo();
        } else {
            createDesktopPlayer(index);
        }
    }
    
    function createDesktopPlayer(index) {
        const videoId = videoIds[index];
        players[index] = new YT.Player('desktop-player-' + index, {
            height: '100%', width: '100%',
            videoId: videoId,
            playerVars: {
                'autoplay': 1, 'mute': 0, 'rel': 0, 
                'playsinline': 1, 'controls': SETTINGS.enableControls ? 1 : 0
            },
            events: {
                'onReady': (event) => { event.target.playVideo(); },
                'onStateChange': onDesktopPlayerStateChange
            }
        });
    }

    function onDesktopPlayerStateChange(event) {
        if (event.data === YT.PlayerState.ENDED) {
            // 현재 재생이 끝난 영상의 인덱스를 찾아 다음 영상 재생
            const iframeId = event.target.getIframe().id;
            const currentIndex = parseInt(iframeId.split('-')[2]);
            playDesktopVideo(currentIndex + 1);
        }
    }

</script>
<script async src="https://www.youtube.com/iframe_api"></script>
</body>
</html>